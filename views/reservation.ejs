<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <!-- Fontawesome -->
    <script src="https://kit.fontawesome.com/acfe1c41fb.js" crossorigin="anonymous"></script>
</head>
<body>
    <div class="container">
        <div style="width:300px;">
            <div>
                <button type="button" onclick="changeMonth(-1);"><i class="fa fa-chevron-left"></i></button>
                <input type="number" id="year" value="2020" style="width:80px; display:initial;" class="form-control">
                <!-- 위에 부분 class가 부트스트랩에서 사용되고 있는 class인데 디자인을 바꿀 거면 class를 바꿔야 함 -->
                <select id="month" class="form-control" style="width:80px; display:initial;" onchange="changeMonth();">
                    <option value="1">1월</option>
                    <option value="2">2월</option>
                    <option value="3">3월</option>
                    <option value="4">4월</option>
                    <option value="5">5월</option>
                    <option value="6">6월</option>
                    <option value="7">7월</option>
                    <option value="8">8월</option>
                    <option value="9">9월</option>
                    <option value="10">10월</option>
                    <option value="11">11월</option>
                    <option value="12">12월</option>
                </select>
                <button type="button" onclick="changeMonth(+1);"><i class="fa fa-chevron-right"></i></button>
            </div>
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>일</th>
                        <th>월</th>
                        <th>화</th>
                        <th>수</th>
                        <th>목</th>
                        <th>금</th>
                        <th>토</th>
                    </tr>
                </thead>
                <tbody id="tb_body"></tbody>
            </table>
        </div> 
    </div>
    <form>
        <input type="text" id="input_date">
        <input type="text" id="output_date">
        <input type="reset">
    </form>
    


    <!-- Jquery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>

    <script>
        
        // 윤년 계산
        function checkLeapYear(year){
            if(year%400 == 0){
                return true;
            }
            else if(year%100 == 0){
                return false;
            }
            else if(year%4 == 0){
                return true;
            }
            else{
                return false;
            }
        }

        function getFirstDayOfWeek(year, month){
            if(month < 10) month = "0" + month;

            return(new Date(year+"-"+month+"-01")).getDay();
        }

        function changeYearMonth(year, month){
            let month_day = [31,28,31,30,31,30,31,31,30,31,30,31];

            if(month == 2){
                if(checkLeapYear(year)) month_day[1] = 29;
            }

            let first_day_of_week = getFirstDayOfWeek(year, month);
            let arr_calendar = [];

            // 앞에 비어있는 부분
            for(let i=0; i<first_day_of_week; i++){
                arr_calendar.push("");
            }
            
            // 가운데
            for(let i=1; i<month_day[month-1]; i++){
                arr_calendar.push(String(i));
            }

            // 뒤에 비어있는 부분
            let remain_day = 7 - (arr_calendar.length%7);
            if(remain_day < 7 ){
                for(let i=0; i<remain_day; i++){
                    arr_calendar.push("");
                }
            }
            
            renderCalendar(arr_calendar);
        }

        function renderCalendar(data){
            let h = [];
            for(let i=0; i<data.length; i++){
                if(i==0){
                    h.push('<tr>');
                }
                else if(i%7 == 0){
                    h.push('</tr>');
                    h.push('<tr>');
                }
                h.push('<td onclick="setDate(' + data[i] + ');" style="cusrsor:pointer;">' + data[i] + '</td>');
            }
            
            h.push('</tr>');

            $("#tb_body").html(h.join(""));
        }

        // 실시간 예약 input1 input2에 집어넣기
        function setDate(day){
            if(day < 10) day = "0" + day;

            var valueById = $("#input_date").val();
            if(valueById == ''){
                $("#input_date").val(current_year + "-" + current_month + "-" + day);
            }
            else{
                $("#output_date").val(current_year + "-" + current_month + "-" + day);
            }
        }

        function changeMonth(diff){
            if(diff == undefined){
                current_month = parseInt($("#month").val());
            }
            else{
                current_month = current_month + diff;

                if(current_month == 0){
                    current_year = current_year -1;
                    current_month = 12
                }
                else if(current_month == 13){
                    current_year = current_year + 1;
                    current_month = 1;
                }
            }

            loadCalendar();
        }

        function loadCalendar(){
            $("#year").val(current_year);
            $("#month").val(current_month);
            changeYearMonth(current_year,current_month);
        }


        let current_year = (new Date()).getFullYear();
        let current_month = (new Date()).getMonth() +1;

        $("#year").val(current_year);
        $("#month").val(current_month);

        changeYearMonth(current_year,current_month);


        //
        // if input.value != '' {
        //     두번째 INPUT
        // }

        // if($(#input_value").val())

        

    </script>
</body>
</html>